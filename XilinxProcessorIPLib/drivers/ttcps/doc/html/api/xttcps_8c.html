<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   xttcps.c File Reference
</title>
<link href="$DriverApiDocsCssPath" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xttcps.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
This file contains the implementation of the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> driver. This driver controls the operation of one timer counter in the Triple Timer Counter (TTC) module in the Ps block. Refer to xttcps.h for more detailed description of the driver.<p>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who    Date     Changes
 ----- ------ -------- -------------------------------------------------
 1.00a drg/jz 01/21/10 First release</pre><p>
<pre> </pre> 
<p>
<code>#include &quot;xttcps.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xttcps_8c.html#3d36a395d111c780925b5377d26d7075">XTtcPs_CfgInitialize</a> (<a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *InstancePtr, <a class="el" href="struct_x_ttc_ps___config.html">XTtcPs_Config</a> *ConfigPtr, u32 EffectiveAddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xttcps_8c.html#53e8a760f66b2df3c51bd7b324a5b27e">XTtcPs_SetMatchValue</a> (<a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *InstancePtr, u8 MatchIndex, u16 Value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">u16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xttcps_8c.html#dade7b43f14e6a67639a24aec81523dd">XTtcPs_GetMatchValue</a> (<a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *InstancePtr, u8 MatchIndex)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xttcps_8c.html#8a4b066dd36cfe4ae51f61fd13ed347a">XTtcPs_SetPrescaler</a> (<a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *InstancePtr, u8 PrescalerValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">u8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xttcps_8c.html#0097c0d3163a0f78da80c712fcc6aa96">XTtcPs_GetPrescaler</a> (<a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xttcps_8c.html#061af119dcd684cfe3edd6997a5de2f6">XTtcPs_CalcIntervalFromFreq</a> (<a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *InstancePtr, u32 Freq, u16 *Interval, u8 *Prescaler)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="061af119dcd684cfe3edd6997a5de2f6"></a><!-- doxytag: member="xttcps.c::XTtcPs_CalcIntervalFromFreq" ref="061af119dcd684cfe3edd6997a5de2f6" args="(XTtcPs *InstancePtr, u32 Freq, u16 *Interval, u8 *Prescaler)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XTtcPs_CalcIntervalFromFreq           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Freq</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u16 *&nbsp;</td>
          <td class="mdname" nowrap> <em>Interval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u8 *&nbsp;</td>
          <td class="mdname" nowrap> <em>Prescaler</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function calculates the interval value as well as the prescaler value for a given frequency.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Freq</em>&nbsp;</td><td>is the requested output frequency for the device. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Interval</em>&nbsp;</td><td>is the interval value for the given frequency, it is the output value for this function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Prescaler</em>&nbsp;</td><td>is the prescaler value for the given frequency, it is the output value for this function.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Upon successful calculation for the given frequency, Interval and Prescaler carry the settings for the timer counter; Upon unsuccessful calculation, Interval and Prescaler are set to 0xFF(FF) for their maximum values to signal the caller of failure. Therefore, caller needs to check the return interval or prescaler values for whether the function has succeeded. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="3d36a395d111c780925b5377d26d7075"></a><!-- doxytag: member="xttcps.c::XTtcPs_CfgInitialize" ref="3d36a395d111c780925b5377d26d7075" args="(XTtcPs *InstancePtr, XTtcPs_Config *ConfigPtr, u32 EffectiveAddr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XTtcPs_CfgInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct_x_ttc_ps___config.html">XTtcPs_Config</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ConfigPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initializes a specific <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance such that the driver is ready to use. This function initializes a single timer counter in the triple timer counter function block.<p>
The state of the device after initialization is:<ul>
<li>Overflow Mode</li><li>Internal (pclk) selected</li><li>Counter disabled</li><li>All Interrupts disabled</li><li>Output waveforms disabled</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ConfigPtr</em>&nbsp;</td><td>is a reference to a structure containing information about a specific TTC device. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EffectiveAddr</em>&nbsp;</td><td>is the device base address in the virtual memory address space. The caller is responsible for keeping the address mapping from EffectiveAddr to the device physical base address unchanged once this function is invoked. Unexpected errors may occur if the address mapping changes after this function is called. If address translation is not used, then use ConfigPtr-&gt;BaseAddress for this parameter, passing the physical address instead.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
<ul>
<li>XST_SUCCESS if the initialization is successful.</li><li>XST_DEVICE_IS_STARTED if the device is started. It must be stopped to re-initialize.</li></ul>
<p>
<dl compact><dt><b>Note:</b></dt><dd>Device has to be stopped first to call this function to initialize it. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="dade7b43f14e6a67639a24aec81523dd"></a><!-- doxytag: member="xttcps.c::XTtcPs_GetMatchValue" ref="dade7b43f14e6a67639a24aec81523dd" args="(XTtcPs *InstancePtr, u8 MatchIndex)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">u16 XTtcPs_GetMatchValue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>MatchIndex</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to get the value of the match registers. There are three match registers.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MatchIndex</em>&nbsp;</td><td>is the index to the match register to be set. Valid values are 0, 1, or 2.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="0097c0d3163a0f78da80c712fcc6aa96"></a><!-- doxytag: member="xttcps.c::XTtcPs_GetPrescaler" ref="0097c0d3163a0f78da80c712fcc6aa96" args="(XTtcPs *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">u8 XTtcPs_GetPrescaler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function gets the input clock prescaler<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance.</td></tr>
  </table>
</dl>
<pre>
<dl compact><dt><b>Returns:</b></dt><dd>	The value(n) from which the prescalar value is calculated
		as 2^(n+1). Some example values are given below :</dd></dl>
 	Value		Prescaler
 	0		2
 	1		4
 	N		2^(n+1)
 	15		65536
 	16		1
 </pre><p>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="53e8a760f66b2df3c51bd7b324a5b27e"></a><!-- doxytag: member="xttcps.c::XTtcPs_SetMatchValue" ref="53e8a760f66b2df3c51bd7b324a5b27e" args="(XTtcPs *InstancePtr, u8 MatchIndex, u16 Value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XTtcPs_SetMatchValue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>MatchIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u16&nbsp;</td>
          <td class="mdname" nowrap> <em>Value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to set the match registers. There are three match registers.<p>
The match 0 register is special. If the waveform output mode is enabled, the waveform will change polarity when the count matches the value in the match 0 register. The polarity of the waveform output can also be set using the <a class="el" href="xttcps__options_8c.html#6e233b38dfea0638025de8c64d2c8c83">XTtcPs_SetOptions()</a> function.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MatchIndex</em>&nbsp;</td><td>is the index to the match register to be set. Valid values are 0, 1, or 2. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Value</em>&nbsp;</td><td>is the 16-bit value to be set in the match register.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="8a4b066dd36cfe4ae51f61fd13ed347a"></a><!-- doxytag: member="xttcps.c::XTtcPs_SetPrescaler" ref="8a4b066dd36cfe4ae51f61fd13ed347a" args="(XTtcPs *InstancePtr, u8 PrescalerValue)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XTtcPs_SetPrescaler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>PrescalerValue</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function sets the prescaler enable bit and if needed sets the prescaler bits in the control register.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_ttc_ps.html">XTtcPs</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>PrescalerValue</em>&nbsp;</td><td>is a number from 0-16 that sets the prescaler to use. If the parameter is 0 - 15, use a prescaler on the clock of 2^(PrescalerValue+1), or 2-65536. If the parameter is XTTCPS_CLK_CNTRL_PS_DISABLE, do not use a prescaler.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None </dd></dl>
    </td>
  </tr>
</table>
Copyright @ 1995-2014 Xilinx, Inc. All rights reserved. 
