<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   xaxicdma_bdring.c File Reference
</title>
<link href="$DriverApiDocsCssPath" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xaxicdma_bdring.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation for support on Scatter Gather (SG) transfers. It includes the implementation of the BD ring API. There is only one BD ring per DMA engine.<p>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a jz   04/18/10 First release
 2.01a rkv  01/25/11 Replaced with "\r\n" in place on "\n\r" in printf statements
 </pre> 
<p>
<code>#include &quot;xaxicdma.h&quot;</code><br>
<code>#include &quot;<a class="el" href="xaxicdma__i_8h.html">xaxicdma_i.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#3b5d445812b6f009d5f7228073c6f60c">XAxiCdma_BdRingCntCalc</a> (u32 Alignment, u32 Bytes, u32 BdBuffAddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#af17c2119b0a23c43f1c8b2383657277">XAxiCdma_BdRingMemCalc</a> (u32 Alignment, int NumBd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#6603b3faeaffe7c66081c411264a03bd">XAxiCdma_BdRingGetCnt</a> (XAxiCdma *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#86484063ff4544cad0f1c97c4dc910d7">XAxiCdma_BdRingGetFreeCnt</a> (XAxiCdma *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#41a2c367e1348177d58e17a1ce08292b">XAxiCdma_BdRingSnapShotCurrBd</a> (XAxiCdma *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#21ceff1a8e5044d5e279bf02be28bb74">XAxiCdma_BdRingGetCurrBd</a> (XAxiCdma *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#5166504dc6bbb78f99b2d1df85d079f7">XAxiCdma_BdRingNext</a> (XAxiCdma *InstancePtr, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *BdPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#946c0aeda0633c3ae222817c047bf410">XAxiCdma_BdRingPrev</a> (XAxiCdma *InstancePtr, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *BdPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#14bbb0c0cec330837f983cd79ca42dbb">XAxiCdma_BdRingCreate</a> (XAxiCdma *InstancePtr, u32 PhysAddr, u32 VirtAddr, u32 Alignment, int BdCount)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#cb44d41fbe8ba3f2b57306ba56ea5937">XAxiCdma_BdRingClone</a> (XAxiCdma *InstancePtr, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *TemplateBdPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#e47bfeb7f701d7010bf5d057ef2ceb9c">XAxiCdma_BdRingAlloc</a> (XAxiCdma *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> **BdSetPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#1779c5ca98055b95134039a003549601">XAxiCdma_BdRingUnAlloc</a> (XAxiCdma *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *BdSetPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#c95a4bdc6b115a56b0c7c2c454689500">XAxiCdma_BdRingToHw</a> (XAxiCdma *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *BdSetPtr, XAxiCdma_CallBackFn CallBackFn, void *CallBackRef)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#e444862df991a11f61c31dcbe35faf52">XAxiCdma_BdRingFromHw</a> (XAxiCdma *InstancePtr, int BdLimit, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> **BdSetPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#876bf6f267296a7a3010ae0628381233">XAxiCdma_BdRingFree</a> (XAxiCdma *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *BdSetPtr)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="e47bfeb7f701d7010bf5d057ef2ceb9c"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingAlloc" ref="e47bfeb7f701d7010bf5d057ef2ceb9c" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd **BdSetPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingAlloc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>BdSetPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function requests number of BDs from the BD ring.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the pointer to the set of BDs returned</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM if requests non-positive number of BDs</li><li>XST_FAILURE if not enough free BDs available</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="cb44d41fbe8ba3f2b57306ba56ea5937"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingClone" ref="cb44d41fbe8ba3f2b57306ba56ea5937" args="(XAxiCdma *InstancePtr, XAxiCdma_Bd *TemplateBdPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingClone           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>TemplateBdPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function clones all BDs in the BD ring to be the same as the given BD.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>TemplateBdPtr</em>&nbsp;</td><td>is the BD to be copied from</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_DMA_SG_NO_LIST if there is no BD ring</li><li>XST_DEVICE_IS_STARTED if the hardware is running</li><li>XST_DMA_SG_LIST_ERROR is the BD ring is still in use</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="3b5d445812b6f009d5f7228073c6f60c"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingCntCalc" ref="3b5d445812b6f009d5f7228073c6f60c" args="(u32 Alignment, u32 Bytes, u32 BdBuffAddr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingCntCalc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Bytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>BdBuffAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function calculates how many BDs can be built using given number of bytes of memory, according to alignment provided.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Alignment</em>&nbsp;</td><td>is the preferred alignment for the BDs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Bytes</em>&nbsp;</td><td>is the number of bytes of memory to build BDs with </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdBuffAddr</em>&nbsp;</td><td>is the buffer address allocated for the BDs. This is to check the alignment of the buffer to make sure the the buffer is aligned to the BD alignment. An invalid buffer address results in 0.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The number of BDs can be built. 0 means buffer address is not valid.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>The application is responsible to align the buffer before pass it to this function. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="14bbb0c0cec330837f983cd79ca42dbb"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingCreate" ref="14bbb0c0cec330837f983cd79ca42dbb" args="(XAxiCdma *InstancePtr, u32 PhysAddr, u32 VirtAddr, u32 Alignment, int BdCount)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingCreate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>PhysAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>VirtAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>BdCount</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function creates the BD ring for the driver instance. If a BD ring pre-exist of this ring, the previous ring is lost.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>PhysAddr</em>&nbsp;</td><td>is the physical address of the memory for the BD ring </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>VirtAddr</em>&nbsp;</td><td>is the virtual address of the memory for the BD ring </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Alignment</em>&nbsp;</td><td>is the alignment for the BDs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdCount</em>&nbsp;</td><td>is the number of BDs to create in the ring</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM for invalid parameter</li><li>XST_DMA_SG_LIST_ERROR for invalid memory region</li><li>XST_FAILURE if the hardware build is simple mode only</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>For a system that has flat memory layout, then the PhysAddr and the VirtAddr are the same. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="876bf6f267296a7a3010ae0628381233"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingFree" ref="876bf6f267296a7a3010ae0628381233" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd *BdSetPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingFree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdSetPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns the BDs back to the free pool of the BD ring.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to free </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of BDs to be freed</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM if number of BDs is negative</li><li>XST_DMA_SG_LIST_ERROR if the BD ring management has a problem</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="e444862df991a11f61c31dcbe35faf52"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingFromHw" ref="e444862df991a11f61c31dcbe35faf52" args="(XAxiCdma *InstancePtr, int BdLimit, XAxiCdma_Bd **BdSetPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingFromHw           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>BdLimit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>BdSetPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tries to retrieve completed BDs from the hardware.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdLimit</em>&nbsp;</td><td>is the maximum number of completed BDs to retrieve </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of completed BDs</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The number of completed BDs.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="6603b3faeaffe7c66081c411264a03bd"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingGetCnt" ref="6603b3faeaffe7c66081c411264a03bd" args="(XAxiCdma *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingGetCnt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function gets the total number of BDs in the BD ring.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The total number of BDs for this instance</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="21ceff1a8e5044d5e279bf02be28bb74"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingGetCurrBd" ref="21ceff1a8e5044d5e279bf02be28bb74" args="(XAxiCdma *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a>* XAxiCdma_BdRingGetCurrBd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function grabs a copy of the current BD pointer from the hardware.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The BD pointer in CDESC register</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="86484063ff4544cad0f1c97c4dc910d7"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingGetFreeCnt" ref="86484063ff4544cad0f1c97c4dc910d7" args="(XAxiCdma *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingGetFreeCnt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function gets the number of free BDs.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The total number of free BDs for this instance</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="af17c2119b0a23c43f1c8b2383657277"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingMemCalc" ref="af17c2119b0a23c43f1c8b2383657277" args="(u32 Alignment, int NumBd)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingMemCalc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>NumBd</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function calculates how much memory is needed to build requested number of BDs.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Alignment</em>&nbsp;</td><td>is the preferred alignment for the BDs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to be built</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The number of bytes of memory needed to build the BDs</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="5166504dc6bbb78f99b2d1df85d079f7"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingNext" ref="5166504dc6bbb78f99b2d1df85d079f7" args="(XAxiCdma *InstancePtr, XAxiCdma_Bd *BdPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a>* XAxiCdma_BdRingNext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function gets the next BD of the current BD on the BD ring.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the current BD</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The next BD on the ring from the current BD, NULL if passed in BdPtr not valid.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="946c0aeda0633c3ae222817c047bf410"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingPrev" ref="946c0aeda0633c3ae222817c047bf410" args="(XAxiCdma *InstancePtr, XAxiCdma_Bd *BdPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a>* XAxiCdma_BdRingPrev           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function gets the previous BD of the current BD on the BD ring.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the current BD</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The previous BD on the ring from the current BD</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="41a2c367e1348177d58e17a1ce08292b"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingSnapShotCurrBd" ref="41a2c367e1348177d58e17a1ce08292b" args="(XAxiCdma *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XAxiCdma_BdRingSnapShotCurrBd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function grabs a copy of the current BD pointer from the hardware. It is normally used to prepare for the hardware reset. The snapshot of the current BD pointer should be reloaded once the reset is done.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="c95a4bdc6b115a56b0c7c2c454689500"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingToHw" ref="c95a4bdc6b115a56b0c7c2c454689500" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd *BdSetPtr, XAxiCdma_CallBackFn CallBackFn, void *CallBackRef)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingToHw           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdSetPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>XAxiCdma_CallBackFn&nbsp;</td>
          <td class="mdname" nowrap> <em>CallBackFn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>CallBackRef</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tries to enqueue the number of BDs to the hardware.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to enqueue </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of BDs to be enqueued </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CallBackFn</em>&nbsp;</td><td>is the callback function for this transfer, NULL is fine </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CallBackRef</em>&nbsp;</td><td>is the callback reference pointer</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM if enqueues negative number of BDs or zero transfer len</li><li>XST_DMA_SG_LIST_ERROR if BD ring management has a problem</li><li>XST_FIFO_NO_ROOM if the interrupt handler array is full</li><li>XST_FAILURE for: Hardware is in invalid state, for example, reset failed Or, the hardware build is simple mode only</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="1779c5ca98055b95134039a003549601"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingUnAlloc" ref="1779c5ca98055b95134039a003549601" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd *BdSetPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiCdma_BdRingUnAlloc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">XAxiCdma *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="xaxicdma__bd_8h.html#c631a91d349cb216f192782ddc572c8d">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdSetPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tries to free the number of BDs back to the ring.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to return </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of BDs to be returned</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM if to free non-positive number of BDs</li><li>XST_FAILURE if BD ring management shows an error</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
Copyright @ 1995-2014 Xilinx, Inc. All rights reserved. 
