<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   xnandps_bbm.h File Reference
</title>
<link href="$DriverApiDocsCssPath" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xnandps_bbm.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
This file implements the Bad Block Management(BBM) functionality. This is similar to the Bad Block Management which is a part of the MTD subsystem in Linux. The factory marked bad blocks are scanned initially and a Bad Block Table(BBT) is created in the memory. This table is also written to the flash so that upon reboot, the BBT is read back from the flash and loaded into the memory instead of scanning every time. The Bad Block Table(BBT) is written into one of the the last four blocks in the flash memory. The last four blocks are marked as Reserved so that user can't erase/program those blocks.<p>
There are two bad block tables, a primary table and a mirror table. The tables are versioned and incrementing version number is used to detect and recover from interrupted updates. Each table is stored in a separate block, beginning in the first page of that block. Only two blocks would be necessary in the absence of bad blocks within the last four; the range of four provides a little slack in case one or two of those blocks is bad. These blocks are marked as reserved and cannot be programmed by the user. A NAND Flash device with 3 or more factory bad blocks in the last 4 cannot be used. The bad block table signature is written into the spare data area of the pages containing bad block table so that upon rebooting the bad block table signature is searched and the bad block table is loaded into RAM. The signature is "Bbt0" for primary Bad Block Table and "1tbB" for Mirror Bad Block Table. The version offset follows the signature offset in the spare data area. The version number increments on every update to the bad block table and the version wraps at 0xff.<p>
Each block in the Bad Block Table(BBT) is represented by 2 bits. The two bits are encoded as follows in RAM BBT. 0'b00 -&gt; Good Block 0'b01 -&gt; Block is bad due to wear 0'b10 -&gt; Reserved block 0'b11 -&gt; Factory marked bad block<p>
While writing to the flash the two bits are encoded as follows. 0'b00 -&gt; Factory marked bad block 0'b01 -&gt; Reserved block 0'b10 -&gt; Block is bad due to wear 0'b11 -&gt; Good Block<p>
The user can check for the validity of the block using the API XNandPs_IsBlockBad and take the action based on the return value. Also user can update the bad block table using XNandPs_MarkBlockBad API.<p>
<dl compact><dt><b>Note:</b></dt><dd>None</dd></dl>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who    Date    	   Changes
 ----- ----   ----------  -----------------------------------------------
 1.00a nm     12/10/2010  First release
 </pre> 
<p>
<code>#include &quot;xnandps.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#3f5115dcbb01496aa8978946b3337a9e">XNANDPS_BLOCK_GOOD</a>&nbsp;&nbsp;&nbsp;0x0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#12e0b32eea1021300dc35d5a0f8e923a">XNANDPS_BLOCK_BAD</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#840ba0c92ab47dfce26efa2774b6339b">XNANDPS_BLOCK_RESERVED</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#645bad26282ca147e76c7d01a3b04025">XNANDPS_BLOCK_FACTORY_BAD</a>&nbsp;&nbsp;&nbsp;0x3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#d400c1d2b04bb22b9add7c204b9293f2">XNANDPS_FLASH_BLOCK_GOOD</a>&nbsp;&nbsp;&nbsp;0x3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#292d7812bd54c4895d69d70c44f521ef">XNANDPS_FLASH_BLOCK_BAD</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#c471499b27da40265924f9afec6e930e">XNANDPS_FLASH_BLOCK_RESERVED</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#51b81e8d0d6c003037983ee74d2ac9ad">XNANDPS_FLASH_BLOCK_FACTORY_BAD</a>&nbsp;&nbsp;&nbsp;0x0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#eb7396c26c105fa723ba48f7054bf635">XNANDPS_BBT_SCAN_2ND_PAGE</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#224e0cbc431761fdc6c6184681f5ce27">XNANDPS_BBT_DESC_PAGE_OFFSET</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#169c446159a15973808d726c72f4fb3b">XNANDPS_BBT_DESC_SIG_OFFSET</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#09afa9d703154df9fd10661eb6633fa8">XNANDPS_BBT_DESC_VER_OFFSET</a>&nbsp;&nbsp;&nbsp;12</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#c82965eaf8cca6383f132f99edfcad6e">XNANDPS_BBT_DESC_SIG_LEN</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#d3fa452778b585455418aa1a63b361f8">XNANDPS_BBT_DESC_MAX_BLOCKS</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#d4c673415f33ce39cd9cec78ffd600f9">XNANDPS_BBT_BLOCK_SHIFT</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#c4b576508db3c74c1566652ac94a7dce">XNANDPS_BBT_ENTRY_NUM_BLOCKS</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#2ee2cf72cffc5259c0cb64b9c0c9acc3">XNANDPS_BB_PATTERN_OFFSET_SMALL_PAGE</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#0f279ca0b85239b0857a4c04586ac601">XNANDPS_BB_PATTERN_LENGTH_SMALL_PAGE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#51152dc5c2f46f23dafaed740ff3c362">XNANDPS_BB_PATTERN_OFFSET_LARGE_PAGE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#b682238520514e3b10e5eabc4e008e83">XNANDPS_BB_PATTERN_LENGTH_LARGE_PAGE</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#e0c9d70b06857c35a8b2875b8c302bd3">XNANDPS_BB_PATTERN</a>&nbsp;&nbsp;&nbsp;0xFF</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#b81d170749e252d3b8bdf625b85b6ace">XNANDPS_BLOCK_TYPE_MASK</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#c5b50d8b9be9c858c4cea350486af222">XNANDPS_BLOCK_SHIFT_MASK</a>&nbsp;&nbsp;&nbsp;0x06</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#e2a65471ffd7011da334ac0af03d9449">XNandPs_BbtBlockShift</a>(Block)&nbsp;&nbsp;&nbsp;((Block * 2) &amp; XNANDPS_BLOCK_SHIFT_MASK)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#5785e54eafd1d46c2abdfb566a8fdbd4">XNandPs_IsBlockBad</a> (<a class="el" href="struct_x_nand_ps_tag.html">XNandPs</a> *InstancePtr, u32 Block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xnandps__bbm_8h.html#16947337dc8ca84a7d6c086b30e6531f">XNandPs_MarkBlockBad</a> (<a class="el" href="struct_x_nand_ps_tag.html">XNandPs</a> *InstancePtr, u32 Block)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="e0c9d70b06857c35a8b2875b8c302bd3"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BB_PATTERN" ref="e0c9d70b06857c35a8b2875b8c302bd3" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BB_PATTERN&nbsp;&nbsp;&nbsp;0xFF          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block pattern to search in a page     </td>
  </tr>
</table>
<a class="anchor" name="b682238520514e3b10e5eabc4e008e83"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BB_PATTERN_LENGTH_LARGE_PAGE" ref="b682238520514e3b10e5eabc4e008e83" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BB_PATTERN_LENGTH_LARGE_PAGE&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block pattern length     </td>
  </tr>
</table>
<a class="anchor" name="0f279ca0b85239b0857a4c04586ac601"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BB_PATTERN_LENGTH_SMALL_PAGE" ref="0f279ca0b85239b0857a4c04586ac601" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BB_PATTERN_LENGTH_SMALL_PAGE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block pattern length     </td>
  </tr>
</table>
<a class="anchor" name="51152dc5c2f46f23dafaed740ff3c362"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BB_PATTERN_OFFSET_LARGE_PAGE" ref="51152dc5c2f46f23dafaed740ff3c362" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BB_PATTERN_OFFSET_LARGE_PAGE&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block pattern offset in a large page     </td>
  </tr>
</table>
<a class="anchor" name="2ee2cf72cffc5259c0cb64b9c0c9acc3"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BB_PATTERN_OFFSET_SMALL_PAGE" ref="2ee2cf72cffc5259c0cb64b9c0c9acc3" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BB_PATTERN_OFFSET_SMALL_PAGE&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block pattern offset in a page     </td>
  </tr>
</table>
<a class="anchor" name="d4c673415f33ce39cd9cec78ffd600f9"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_BLOCK_SHIFT" ref="d4c673415f33ce39cd9cec78ffd600f9" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_BLOCK_SHIFT&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block shift value for a block in BBT     </td>
  </tr>
</table>
<a class="anchor" name="d3fa452778b585455418aa1a63b361f8"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_DESC_MAX_BLOCKS" ref="d3fa452778b585455418aa1a63b361f8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_DESC_MAX_BLOCKS&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block Table max blocks     </td>
  </tr>
</table>
<a class="anchor" name="224e0cbc431761fdc6c6184681f5ce27"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_DESC_PAGE_OFFSET" ref="224e0cbc431761fdc6c6184681f5ce27" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_DESC_PAGE_OFFSET&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Page offset of Bad Block Table Desc     </td>
  </tr>
</table>
<a class="anchor" name="c82965eaf8cca6383f132f99edfcad6e"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_DESC_SIG_LEN" ref="c82965eaf8cca6383f132f99edfcad6e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_DESC_SIG_LEN&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block Table signature length     </td>
  </tr>
</table>
<a class="anchor" name="169c446159a15973808d726c72f4fb3b"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_DESC_SIG_OFFSET" ref="169c446159a15973808d726c72f4fb3b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_DESC_SIG_OFFSET&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad Block Table signature offset     </td>
  </tr>
</table>
<a class="anchor" name="09afa9d703154df9fd10661eb6633fa8"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_DESC_VER_OFFSET" ref="09afa9d703154df9fd10661eb6633fa8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_DESC_VER_OFFSET&nbsp;&nbsp;&nbsp;12          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bad block Table version offset     </td>
  </tr>
</table>
<a class="anchor" name="c4b576508db3c74c1566652ac94a7dce"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_ENTRY_NUM_BLOCKS" ref="c4b576508db3c74c1566652ac94a7dce" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_ENTRY_NUM_BLOCKS&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Num of blocks in one BBT entry     </td>
  </tr>
</table>
<a class="anchor" name="eb7396c26c105fa723ba48f7054bf635"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BBT_SCAN_2ND_PAGE" ref="eb7396c26c105fa723ba48f7054bf635" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BBT_SCAN_2ND_PAGE&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Scan the second page for bad block information     </td>
  </tr>
</table>
<a class="anchor" name="e2a65471ffd7011da334ac0af03d9449"></a><!-- doxytag: member="xnandps_bbm.h::XNandPs_BbtBlockShift" ref="e2a65471ffd7011da334ac0af03d9449" args="(Block)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNandPs_BbtBlockShift          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Block&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((Block * 2) &amp; XNANDPS_BLOCK_SHIFT_MASK)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This macro returns the Block shift value corresponding to a Block.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>is the block number.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Block shift value</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>None. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="12e0b32eea1021300dc35d5a0f8e923a"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BLOCK_BAD" ref="12e0b32eea1021300dc35d5a0f8e923a" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BLOCK_BAD&nbsp;&nbsp;&nbsp;0x1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block is bad     </td>
  </tr>
</table>
<a class="anchor" name="645bad26282ca147e76c7d01a3b04025"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BLOCK_FACTORY_BAD" ref="645bad26282ca147e76c7d01a3b04025" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BLOCK_FACTORY_BAD&nbsp;&nbsp;&nbsp;0x3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Factory marked bad block     </td>
  </tr>
</table>
<a class="anchor" name="3f5115dcbb01496aa8978946b3337a9e"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BLOCK_GOOD" ref="3f5115dcbb01496aa8978946b3337a9e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BLOCK_GOOD&nbsp;&nbsp;&nbsp;0x0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block is good     </td>
  </tr>
</table>
<a class="anchor" name="840ba0c92ab47dfce26efa2774b6339b"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BLOCK_RESERVED" ref="840ba0c92ab47dfce26efa2774b6339b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BLOCK_RESERVED&nbsp;&nbsp;&nbsp;0x2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reserved block     </td>
  </tr>
</table>
<a class="anchor" name="c5b50d8b9be9c858c4cea350486af222"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BLOCK_SHIFT_MASK" ref="c5b50d8b9be9c858c4cea350486af222" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BLOCK_SHIFT_MASK&nbsp;&nbsp;&nbsp;0x06          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block shift mask for a Bad Block Table entry byte     </td>
  </tr>
</table>
<a class="anchor" name="b81d170749e252d3b8bdf625b85b6ace"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_BLOCK_TYPE_MASK" ref="b81d170749e252d3b8bdf625b85b6ace" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_BLOCK_TYPE_MASK&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block type mask     </td>
  </tr>
</table>
<a class="anchor" name="292d7812bd54c4895d69d70c44f521ef"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_FLASH_BLOCK_BAD" ref="292d7812bd54c4895d69d70c44f521ef" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_FLASH_BLOCK_BAD&nbsp;&nbsp;&nbsp;0x2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block is bad     </td>
  </tr>
</table>
<a class="anchor" name="51b81e8d0d6c003037983ee74d2ac9ad"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_FLASH_BLOCK_FACTORY_BAD" ref="51b81e8d0d6c003037983ee74d2ac9ad" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_FLASH_BLOCK_FACTORY_BAD&nbsp;&nbsp;&nbsp;0x0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Factory marked bad block     </td>
  </tr>
</table>
<a class="anchor" name="d400c1d2b04bb22b9add7c204b9293f2"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_FLASH_BLOCK_GOOD" ref="d400c1d2b04bb22b9add7c204b9293f2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_FLASH_BLOCK_GOOD&nbsp;&nbsp;&nbsp;0x3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Block is good     </td>
  </tr>
</table>
<a class="anchor" name="c471499b27da40265924f9afec6e930e"></a><!-- doxytag: member="xnandps_bbm.h::XNANDPS_FLASH_BLOCK_RESERVED" ref="c471499b27da40265924f9afec6e930e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XNANDPS_FLASH_BLOCK_RESERVED&nbsp;&nbsp;&nbsp;0x1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reserved block     </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="5785e54eafd1d46c2abdfb566a8fdbd4"></a><!-- doxytag: member="xnandps_bbm.h::XNandPs_IsBlockBad" ref="5785e54eafd1d46c2abdfb566a8fdbd4" args="(XNandPs *InstancePtr, u32 Block)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XNandPs_IsBlockBad           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_nand_ps_tag.html">XNandPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Block</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function checks whether a block is bad or not.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the pointer to the XNandPs instance.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>is the block number.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful.</li><li>XST_FAILURE if fail. </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="16947337dc8ca84a7d6c086b30e6531f"></a><!-- doxytag: member="xnandps_bbm.h::XNandPs_MarkBlockBad" ref="16947337dc8ca84a7d6c086b30e6531f" args="(XNandPs *InstancePtr, u32 Block)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XNandPs_MarkBlockBad           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_nand_ps_tag.html">XNandPs</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Block</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function marks a block as bad in the RAM based Bad Block Table(BBT). It also updates the Bad Block Table(BBT) in the flash.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the pointer to the XNandPs instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>is the block number.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful.</li><li>XST_FAILURE if fail. </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
Copyright @ 1995-2014 Xilinx, Inc. All rights reserved. 
