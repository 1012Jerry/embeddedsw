<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   xtrafgen.c File Reference
</title>
<link href="$DriverApiDocsCssPath" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xtrafgen.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
This file implements AXI Traffic Generator device-wise initialization and control functions. For more information on the implementation of this driver, see xtrafgen.h.<p>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a srt  01/24/13 First release
 1.01a adk  03/09/13 Updated driver to Support Static and Streaming mode.
 2.00a adk  16/09/13 Fixed CR:737291
 </pre> 
<p>
<code>#include &quot;xtrafgen.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#0cc931f68275cd5e6afcf67b7e253770">XTrafGen_GetCmdInfo</a>(InstancePtr)&nbsp;&nbsp;&nbsp;(&amp;((InstancePtr)-&gt;CmdInfo))</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#1000571d3498ef3d8806730f2d270b41">XTrafGen_CfgInitialize</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr, <a class="el" href="struct_x_traf_gen___config.html">XTrafGen_Config</a> *Config, u32 EffectiveAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#1401030de23b8a445ecf25a0edc54f18">XTrafGen_AddCommand</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr, <a class="el" href="struct_x_traf_gen___cmd.html">XTrafGen_Cmd</a> *CmdPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#2b2e7e40a8dde384e38a1a0e6d69bc78">XTrafGen_GetLastValidIndex</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr, u32 RdWrFlag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#a93f1076451c108b920222b97fb3cb74">XTrafGen_WriteCmdsToHw</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#a646c37ef5d41930435a1a868666bbb9">XTrafGen_EraseAllCommands</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#c588723e0b34d456242d2e9799b865da">XTrafGen_AccessMasterRam</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr, u32 Offset, int Length, u8 RdWrFlag, u32 *Data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xtrafgen_8c.html#0ac70cd176f70ee7275e3aa5a17441a1">XTrafGen_PrintCmds</a> (<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="0cc931f68275cd5e6afcf67b7e253770"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_GetCmdInfo" ref="0cc931f68275cd5e6afcf67b7e253770" args="(InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XTrafGen_GetCmdInfo          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">InstancePtr&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(&amp;((InstancePtr)-&gt;CmdInfo))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get Command Info pointer<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Command Info structure</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>C-style signature: <a class="el" href="struct_x_traf_gen___cmd_info.html">XTrafGen_CmdInfo</a> *XTrafGen_GetCmdInfo(<a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *InstancePtr) </dd></dl>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c588723e0b34d456242d2e9799b865da"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_AccessMasterRam" ref="c588723e0b34d456242d2e9799b865da" args="(XTrafGen *InstancePtr, u32 Offset, int Length, u8 RdWrFlag, u32 *Data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XTrafGen_AccessMasterRam           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>RdWrFlag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32 *&nbsp;</td>
          <td class="mdname" nowrap> <em>Data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write or Read Master RAM<p>
The MSTRAM has 8 KB of internal RAM used for the following:<ul>
<li>Take data from this RAM for write transactions</li><li>Store data to this RAM for read transaction</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Offset</em>&nbsp;</td><td>is the offset value in Master RAM. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Length</em>&nbsp;</td><td>is the size of data to write/read. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>RdWrFlag</em>&nbsp;</td><td>specifies whether to write or read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Data</em>&nbsp;</td><td>is the pointer to array which contains data to write or reads data into. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="1401030de23b8a445ecf25a0edc54f18"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_AddCommand" ref="1401030de23b8a445ecf25a0edc54f18" args="(XTrafGen *InstancePtr, XTrafGen_Cmd *CmdPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XTrafGen_AddCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct_x_traf_gen___cmd.html">XTrafGen_Cmd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>CmdPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a command to the software list of commands.<p>
This function prepares the four Command Words and one Parameter Word from the Command structure passed from the user application. It then adds to a list of commands (maintained in the software). Both CMDRAM and PARAMRAM are divided into two regions, one for reads and one for writes. Each region can hold 256 commands with each entry containing four Command RAM words and one Parameter RAM word.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CmdPtr</em>&nbsp;</td><td>is a pointer to Command structure.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful</li><li>XST_FAILURE if reached max number of command entries </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="1000571d3498ef3d8806730f2d270b41"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_CfgInitialize" ref="1000571d3498ef3d8806730f2d270b41" args="(XTrafGen *InstancePtr, XTrafGen_Config *Config, u32 EffectiveAddress)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XTrafGen_CfgInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct_x_traf_gen___config.html">XTrafGen_Config</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Config</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveAddress</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function initializes a AXI Traffic Generator device. This function must be called prior to using a AXI Traffic Generator Device. Initializing a engine includes setting up the register base address, setting up the instance data, and ensuring the hardware is in a quiescent state.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi Traffic Generator instance to be worked on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CfgPtr</em>&nbsp;</td><td>references the structure holding the hardware configuration for the Axi Traffic Generator core to initialize. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EffectiveAddr</em>&nbsp;</td><td>is the device base address in the virtual memory address space. The caller is responsible for keeping the address mapping from EffectiveAddr to the device physical base address unchanged once this function is invoked. Unexpected errors may occur if the address mapping changes after this function is called. If address translation is not used, use Config-&gt;BaseAddress for this parameters, passing the physical address instead.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for successful initialization</li><li>XST_INVALID_PARAM if pointer to the configuration structure is NULL </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a646c37ef5d41930435a1a868666bbb9"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_EraseAllCommands" ref="a646c37ef5d41930435a1a868666bbb9" args="(XTrafGen *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XTrafGen_EraseAllCommands           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Erase all Command Entry values<p>
This function erases all the 256 entries of both write and read regions with each entry containing four command words and parameter word.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful</li><li>XST_FAILURE if programming internal RAMs failed </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="2b2e7e40a8dde384e38a1a0e6d69bc78"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_GetLastValidIndex" ref="2b2e7e40a8dde384e38a1a0e6d69bc78" args="(XTrafGen *InstancePtr, u32 RdWrFlag)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XTrafGen_GetLastValidIndex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>RdWrFlag</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get last Valid Command Index of Write/Read region<p>
The last valid command index is used to set 'my_depend' and 'other_depend' fields of the Command RAM (Word 2).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>RdWrFlag</em>&nbsp;</td><td>specifies a Read or Write Region</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>Last Valid Command Index </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="0ac70cd176f70ee7275e3aa5a17441a1"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_PrintCmds" ref="0ac70cd176f70ee7275e3aa5a17441a1" args="(XTrafGen *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XTrafGen_PrintCmds           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Display Command Entry values<p>
This function prints all the 256 entries of both write and read regions with each entry containing four command words and parameter word.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a93f1076451c108b920222b97fb3cb74"></a><!-- doxytag: member="xtrafgen.c::XTrafGen_WriteCmdsToHw" ref="a93f1076451c108b920222b97fb3cb74" args="(XTrafGen *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XTrafGen_WriteCmdsToHw           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_x_traf_gen.html">XTrafGen</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write Commands to internal Command and Parameter RAMs<p>
This function writes all the prepared commands to hardware.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the Axi TrafGen instance to be worked on.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful</li><li>XST_FAILURE if programming internal RAMs failed </li></ul>
</dd></dl>
    </td>
  </tr>
</table>
Copyright @ 1995-2014 Xilinx, Inc. All rights reserved. 
