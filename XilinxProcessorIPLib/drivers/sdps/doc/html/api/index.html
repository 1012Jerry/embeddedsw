<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>sdps: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="HTML_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xlogo_bg.gif"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sdps
   </div>
   <div id="projectbrief">Xilinx SDK Drivers API Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="globals.html"><span>APIs</span></a></li>
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sdps Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This file contains the implementation of <a class="el" href="struct_x_sd_ps.html" title="The XSdPs driver instance data. ">XSdPs</a> driver.This driver is used initialize read from and write to the SD card. Features such as switching bus width to 4-bit and switching to high speed, changing clock frequency, block size etc. are supported. SD 2.0 uses 1/4 bus width and speeds of 25/50KHz. Initialization, however is done using 1-bit bus width and 400KHz clock frequency. SD commands are classified as broadcast and addressed. Commands can be those with response only (using only command line) or response + data (using command and data lines). Only one command can be sent at a time. During a data transfer however, when dsta lines are in use, certain commands (which use only the command line) can be sent, most often to obtain status. This driver does not support multi card slots at present.</p>
<p>Intialization: This includes initialization on the host controller side to select clock frequency, bus power and default transfer related parameters. The default voltage is 3.3V. On the SD card side, the initialization and identification state diagram is implemented. This resets the card, gives it a unique address/ID and identifies key card related specifications.</p>
<p>Data transfer: The SD card is put in tranfer state to read from or write to it. The default block size is 512 bytes and if supported, default bus width is 4-bit and bus speed is High speed. The read and write functions are implemented in polled mode using ADMA2.</p>
<p>At any point, when key parameters such as block size or clock/speed or bus width are modified, this driver takes care of maintaining the same selection on host and card. All error bits in host controller are monitored by the driver and in the event one of them is set, driver will clear the interrupt status and communicate failure to the upper layer.</p>
<p>File system use: This driver can be used with xilffs library to read and write files to SD. (Please refer to procedure in diskio.c). The file system read/write example in polled mode can used for reference.</p>
<p>There is no example for using SD driver without file system at present. However, the driver can be used without the file system. The glue layer in filesytem can be used as reference for the same. The block count passed to the read/write function in one call is limited by the ADMA2 descriptor table and hence care will have to be taken to call read/write API's in a loop for large file sizes.</p>
<p>Interrupt mode is not supported because it offers no improvement when used with file system.</p>
<p>eMMC support: SD driver supports SD and eMMC based on the "enable MMC" parameter in SDK. The features of eMMC supported by the driver will depend on those supported by the host controller. The current driver supports read/write on eMMC card using 4-bit and high speed mode currently.</p>
<p>Features not supported include - card write protect, password setting, lock/unlock, interrupts, SDMA mode, programmed I/O mode and 64-bit addressed ADMA2, erase/pre-erase commands.</p>
<pre>
MODIFICATION HISTORY:</pre><pre>Ver   Who    Date     Changes
----- ---    -------- -----------------------------------------------
1.00a hk/sg  10/17/13 Initial release
2.0   hk      03/07/14 Version number revised.
2.1   hk     04/18/14 Increase sleep for eMMC switch command.
                      Add sleep for microblaze designs. CR# 781117.
2.2   hk     07/28/14 Make changes to enable use of data cache.
2.3   sk     09/23/14 Send command for relative card address
                      when re-initialization is done.CR# 819614.
      					Use XSdPs_Change_ClkFreq API whenever changing
      					clock.CR# 816586.
2.4	sk	   12/04/14 Added support for micro SD without
						WP/CD. CR# 810655.
      					Checked for DAT Inhibit mask instead of CMD
						Inhibit mask in Cmd Transfer API.
      					Added Support for SD Card v1.0
2.5 	sg		07/09/15 Added SD 3.0 features
      kvn     07/15/15 Modified the code according to MISRAC-2012.
2.6   sk     10/12/15 Added support for SD card v1.0 CR# 840601.
2.7   sk     11/24/15 Considered the slot type befoe checking CD/WP pins.
      sk     12/10/15 Added support for MMC cards.
             01/08/16 Added workaround for issue in auto tuning mode
                      of SDR50, SDR104 and HS200.
      sk     02/16/16 Corrected the Tuning logic.
      sk     03/01/16 Removed Bus Width check for eMMC. CR# 938311.</pre><pre></pre> </div></div><!-- contents -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright &copy; 2015 Xilinx Inc. All rights reserved.</li>
  </ul>
</div>
</body>
</html>
