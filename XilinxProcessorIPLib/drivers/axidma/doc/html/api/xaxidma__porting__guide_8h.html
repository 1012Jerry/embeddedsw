<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   xaxidma_porting_guide.h File Reference
</title>
<link href="$DriverApiDocsCssPath" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xaxidma_porting_guide.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
This is a guide on how to move from using the xlldma driver to use xaxidma driver.<p>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a jz   05/18/10 First release
 2.00a jz   08/10/10 Second release, added in <a class="el" href="xaxidma__g_8c.html">xaxidma_g.c</a>, <a class="el" href="xaxidma__sinit_8c.html">xaxidma_sinit.c</a>,
                     updated tcl file, added <a class="el" href="xaxidma__porting__guide_8h.html">xaxidma_porting_guide.h</a>
 4.00a rkv  02/22/11 Added support for simple DMA mode
 6.00a srt  03/27/12 Added support for MCDMA mode
 7.00a srt  06/18/12 API calls are reverted back for backward compatibility.</pre><p>
<pre> </pre><p>
<b>Overview</b><p>
The API for xaxidma driver is similar to xlldma driver. The prefix for the API functions and structures is XAxiDma_ for the xaxidma driver.<p>
Due to hardware feature changes, signatures of some API functions are a little bit different from the xlldma API functions.<p>
We present API functions:<ul>
<li>That only have prefix changes</li><li>That have different return type</li><li>That are new API functions</li><li>That have been removed</li></ul>
<p>
Note that data structures have different prefix of XAxiDma_. Those API functions, that have data structures with prefix change, are considered as prefix change.<p>
<b>API Functions That Only Have Prefix Changes</b><p>
<pre>
         xlldma driver              |         xaxidma driver (upto v5_00_a)
 -----------------------------------------------------------------------
    XLlDma_Reset(...)               |  XAxiDma_Reset(...)
    XLlDma_BdRingSnapShotCurrBd(...)|  XAxiDma_BdRingSnapShotCurrBd(...)
    XLlDma_BdRingNext(...)          |  XAxiDma_BdRingNext(...)
    XLlDma_BdRingPrev(...)          |  XAxiDma_BdRingPrev(...)
    XLlDma_BdRingGetSr(...)         |  XAxiDma_BdRingGetSr(...)
    XLlDma_BdRingBusy(...)          |  XAxiDma_BdRingBusy(...)
    XLlDma_BdRingIntEnable(...)     |  XAxiDma_BdRingIntEnable(...)
    XLlDma_BdRingIntDisable(...)    |  XAxiDma_BdRingIntDisable(...)
    XLlDma_BdRingIntGetEnabled(...) |  XAxiDma_BdRingIntGetEnabled(...)
    XLlDma_BdRingGetIrq(...)        |  XAxiDma_BdRingGetIrq(...)
    XLlDma_BdRingAckIrq(...)        |  XAxiDma_BdRingAckIrq(...)
    XLlDma_BdRingCreate(...)        |  XAxiDma_BdRingCreate(...)
    XLlDma_BdRingClone(...)         |  XAxiDma_BdRingClone(...)
    XLlDma_BdRingAlloc(...)         |  XAxiDma_BdRingAlloc(...)
    XLlDma_BdRingUnAlloc(...)       |  XAxiDma_BdRingUnAlloc(...)
    XLlDma_BdRingToHw(...)          |  XAxiDma_BdRingToHw(...)
    XLlDma_BdRingFromHw(...)        |  XAxiDma_BdRingFromHw(...)
    XLlDma_BdRingFree(...)          |  XAxiDma_BdRingFree(...)
    XLlDma_BdRingStart(...)         |  XAxiDma_BdRingStart(...)
    XLlDma_BdRingCheck(...)         |  XAxiDma_BdRingCheck(...)
    XLlDma_BdRingSetCoalesce(...)   |  XAxiDma_BdRingSetCoalesce(...)
    XLlDma_BdRingGetCoalesce(...)   |  XAxiDma_BdRingGetCoalesce(...)
    XLlDma_BdRead(...)              |  XAxiDma_BdRead(...)
    XLlDma_BdWrite(...)             |  XAxiDma_BdWrite(...)
    XLlDma_BdClear(...)             |  XAxiDma_BdClear(...)
    XLlDma_BdSetId(...)             |  XAxiDma_BdSetId(...)
    XLlDma_BdGetId(...)             |  XAxiDma_BdGetId(...)
    XLlDma_BdGetLength(...)         |  XAxiDma_BdGetLength(...)
    XLlDma_BdGetBufAddr(...)        |  XAxiDma_BdGetBufAddr(...)</pre><p>
<pre></pre><p>
<b>API Functions That Have Different Return Type</b><p>
Due to possible hardware failures, The caller should check the return value of the following functions.<p>
<pre>
         xlldma driver              |         xaxidma driver
 -----------------------------------------------------------------------
 void XLlDma_Pause(...)             | int XAxiDma_Pause(...)
 void XLlDma_Resume(...)            | int XAxiDma_Resume(...)
 </pre><p>
The following functions have return type changed:<p>
<pre>
         xlldma driver              |         xaxidma driver
 -----------------------------------------------------------------------
 XLlDma_BdRing XLlDma_GetRxRing(...)| <a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * XAxiDma_GetRxRing(...)
 XLlDma_BdRing XLlDma_GetTxRing(...)| <a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * XAxiDma_GetTxRing(...)
 u32 XLlDma_BdRingMemCalc(...)      | int XAxiDma_BdRingMemCalc(...)
 u32 XLlDma_BdRingCntCalc(...)      | int XAxiDma_BdRingCntCalc(...)
 u32 XLlDma_BdRingGetCnt(...)       | int XAxiDma_BdRingGetCnt(...)
 u32 XLlDma_BdRingGetFreeCnt(...)   | int XAxiDma_BdRingGetFreeCnt(...)
 void XLlDma_BdSetLength(...)       | int XAxiDma_BdSetLength(...)
 void XLlDma_BdSetBufAddr(...)      | int XAxiDma_BdSetBufAddr(...)
</pre><p>
<b>API Functions That Are New API Functions</b><p>
Now that the AXI DMA core is a standalone core, some new API are intrduced. Some other functions are added due to hardware interface change, so to replace old API functions.<p>
<ul>
<li><a class="el" href="struct_x_axi_dma___config.html">XAxiDma_Config</a> *XAxiDma_LookupConfig(u32 DeviceId);</li><li>int <a class="el" href="xaxidma_8c.html#f2be96f61d6d7c132103e4647de65fd3">XAxiDma_CfgInitialize(XAxiDma * InstancePtr, XAxiDma_Config *Config)</a>;</li><li>int <a class="el" href="xaxidma_8c.html#b5a62cc4019b4470ed4f72b8dfda9409">XAxiDma_ResetIsDone(XAxiDma * InstancePtr)</a>;</li><li>XAxiDma_Bd * <a class="el" href="xaxidma__bdring_8h.html#693997d70d993740ca63f92e3209e499">XAxiDma_BdRingGetCurrBd(XAxiDma_BdRing* RingPtr)</a>;</li><li>int <a class="el" href="xaxidma__bdring_8h.html#6ab61d79f4e1049c0b2c60f9063fab81">XAxiDma_BdRingHwIsStarted(XAxiDma_BdRing* RingPtr)</a>;</li><li>void <a class="el" href="xaxidma__bdring_8h.html#38bd38b2ca5727da3d7a35d13e109e70">XAxiDma_BdRingDumpRegs(XAxiDma_BdRing *RingPtr)</a>;</li><li>int <a class="el" href="xaxidma__bdring_8h.html#aa7f3bcecba09babb5e83f9a13088fed">XAxiDma_StartBdRingHw(XAxiDma_BdRing* RingPtr)</a>;</li><li>void <a class="el" href="xaxidma__bd_8h.html#3c40fd8a2c694719aed7f2dffc967ca4">XAxiDma_BdSetCtrl(XAxiDma_Bd *BdPtr, u32 Data)</a>;</li><li>u32 <a class="el" href="xaxidma__bd_8h.html#3ba8a7d7fd3ea8f5b70c11560b0a9956">XAxiDma_BdGetCtrl(XAxiDma_Bd* BdPtr)</a>;</li><li>u32 <a class="el" href="xaxidma__bd_8h.html#1562b91e5d42673e15736a4a183f4dbc">XAxiDma_BdGetSts(XAxiDma_Bd* BdPtr)</a>;</li><li>int <a class="el" href="xaxidma__bd_8h.html#5ec31080d894d49f5a0c7d89ce9d1b12">XAxiDma_BdHwCompleted(XAxiDma_Bd* BdPtr)</a>;</li><li>int <a class="el" href="xaxidma__bd_8h.html#0a3f6db7f8ce62a89619f147967a6a18">XAxiDma_BdGetActualLength(XAxiDma_Bd* BdPtr)</a>;</li><li>int <a class="el" href="xaxidma__bd_8h.html#0ba9f2288b5ae1d995c6fd6520086dfd">XAxiDma_BdSetAppWord(XAxiDma_Bd * BdPtr, int Offset, u32 Word)</a>;</li><li>u32 <a class="el" href="xaxidma__bd_8h.html#5c112b83e66c1a925fc671efceef0c68">XAxiDma_BdGetAppWord(XAxiDma_Bd * BdPtr, int Offset, int *Valid)</a>;</li></ul>
<p>
<b>API Functions That Have Been Removed</b><p>
Please see individual function comments for how to replace the removed API function with new API functions.<p>
<ul>
<li>void XLlDma_Initialize(XLlDma * InstancePtr, u32 BaseAddress). This function is replaced by <a class="el" href="xaxidma__sinit_8c.html#f3e5ed103d2c38c7d865690afaa2ff97">XAxiDma_LookupConfig()</a>/XAxiDma_CfgInitialize()</li></ul>
<p>
<ul>
<li>u32 XLlDma_BdRingGetCr(XLlDma_BdRing* RingPtr). This is replaced by <a class="el" href="xaxidma__bdring_8h.html#cd1ce6d4a761810b6cc60f5863b5a200">XAxiDma_BdRingGetError(XAxiDma_BdRing* RingPtr)</a></li></ul>
<p>
<ul>
<li>u32 XLlDma_BdRingSetCr(XLlDma_BdRing* RingPtr, u32 Data). This function is covered by other API functions:<ul>
<li>void <a class="el" href="xaxidma__bdring_8h.html#4bde6bea804d87f4b5a3a286aeff06d7">XAxiDma_BdRingIntEnable(XAxiDma_BdRing* RingPtr, u32 Mask)</a></li><li>void <a class="el" href="xaxidma__bdring_8h.html#e7b6dfa17d3f15ef7a0eac6f077480b5">XAxiDma_BdRingIntDisable(XAxiDma_BdRing* RingPtr, u32 Mask)</a></li><li>int XAxiDma_BdRingSetCoalesce(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, u32 Counter, u32 Timer)</li></ul>
</li></ul>
<p>
<ul>
<li>u32 XLlDma_BdSetStsCtrl(XLlDma_Bd* BdPtr, u32 Data). Replaced by <a class="el" href="xaxidma__bd_8h.html#3c40fd8a2c694719aed7f2dffc967ca4">XAxiDma_BdSetCtrl(XAxiDma_Bd *BdPtr, u32 Data)</a>;</li></ul>
<p>
<ul>
<li>u32 XLlDma_BdGetStsCtrl(XLlDma_Bd* BdPtr). Replaced by <a class="el" href="xaxidma__bd_8h.html#3ba8a7d7fd3ea8f5b70c11560b0a9956">XAxiDma_BdGetCtrl(XAxiDma_Bd* BdPtr)</a> and <a class="el" href="xaxidma__bd_8h.html#1562b91e5d42673e15736a4a183f4dbc">XAxiDma_BdGetSts(XAxiDma_Bd* BdPtr)</a>.</li></ul>
<p>
<b>API Functions That Have Been Added to support simple DMA mode</b><p>
<ul>
<li>u32 <a class="el" href="xaxidma_8c.html#2a20198c9dda6c208b5deb5100d18de3">XAxiDma_Busy(XAxiDma *InstancePtr,int Direction)</a>;</li><li>int XAxiDma_SimpleTransfer(<a class="el" href="struct_x_axi_dma.html">XAxiDma</a> *InstancePtr, u32 BuffAddr, int Length, int Direction);</li><li>XAxiDma_HasSg(InstancePtr);</li><li>XAxiDma_IntrEnable(InstancePtr,Mask,Direction);</li><li>XAxiDma_IntrGetEnabled(InstancePtr, Direction);</li><li>XAxiDma_IntrDisable(InstancePtr, Mask, Direction);</li><li>XAxiDma_IntrGetIrq(InstancePtr, Direction);</li><li>XAxiDma_IntrAckIrq(InstancePtr, Mask, Direction);</li></ul>
<p>
<b> For xaxidma driver v6_00_a Multiple Channel Support --------------------------------------------------- This driver supports Multi-channel mode and accordingly some APIs are changed to index multiple channels. Few new APIs are added.<ul>
<li>Changed APIs * XAxiDma_GetRxRing(InstancePtr, RingIndex) * XAxiDma_Start(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_Started(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_Pause(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_Resume(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_SimpleTransfer(<a class="el" href="struct_x_axi_dma.html">XAxiDma</a> *InstancePtr, u32 BuffAddr, u32 Length, int Direction, int RingIndex) * XAxiDma_StartBdRingHw(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdRingStart(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdRingToHw(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int NumBd, XAxiDma_Bd * BdSetPtr, int RingIndex) * XAxiDma_BdRingDumpRegs(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdRingSnapShotCurrBd(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdSetLength(XAxiDma_Bd *BdPtr, u32 LenBytes, u32 LengthMask) * <a class="el" href="xaxidma__bd_8h.html#0a3f6db7f8ce62a89619f147967a6a18">XAxiDma_BdGetActualLength(BdPtr, LengthMask)</a> * <a class="el" href="xaxidma__bd_8h.html#7818396ebd146644473e0451a49a372a">XAxiDma_BdGetLength(BdPtr, LengthMask)</a></li></ul>
</b><p>
<b><ul>
<li>New APIs * XAxiDma_SelectKeyHole(<a class="el" href="struct_x_axi_dma.html">XAxiDma</a> *InstancePtr, int Direction, int Select) * XAxiDma_UpdateBdRingCDesc(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * <a class="el" href="xaxidma__bd_8h.html#6900bc7cc585ddddfa405e9829fb3e13">XAxiDma_BdSetTId()</a> * <a class="el" href="xaxidma__bd_8h.html#0305b012d2213d08916dada5ee4bfef3">XAxiDma_BdGetTId()</a> * <a class="el" href="xaxidma__bd_8h.html#b38f749da8a4d95cb02fe8f2f9202ddb">XAxiDma_BdSetTDest()</a> * <a class="el" href="xaxidma__bd_8h.html#7035b244e149587c0957f7aa9d35d1be">XAxiDma_BdGetTDest()</a> * <a class="el" href="xaxidma__bd_8h.html#c1f8f6b47d27e2ca73a5d6b8deeceabd">XAxiDma_BdSetTUser()</a> * <a class="el" href="xaxidma__bd_8h.html#9ba0905375e2553fe683a9b8911232ec">XAxiDma_BdGetTUser()</a> * <a class="el" href="xaxidma__bd_8h.html#fa3c16ffb58cf8a5235aac384d9696a5">XAxiDma_BdSetARCache()</a> * <a class="el" href="xaxidma__bd_8h.html#5795583cebb8a556827f9ef7b883953c">XAxiDma_BdGetARCache()</a> * <a class="el" href="xaxidma__bd_8h.html#b56d0a11fb09f2628c315bd3c6e45348">XAxiDma_BdSetARUser()</a> * <a class="el" href="xaxidma__bd_8h.html#e3aee5f94e5cc4b65dd6fe6cf7d94e3a">XAxiDma_BdGetARUser()</a> * <a class="el" href="xaxidma__bd_8h.html#b4e81384aba0cbff2253b46796916a9e">XAxiDma_BdSetStride()</a> * <a class="el" href="xaxidma__bd_8h.html#4c8facdc3f30df38187ca4040f70ac6a">XAxiDma_BdGetStride()</a> * <a class="el" href="xaxidma__bd_8h.html#196e1d174bd95be1df70f683f1564e7f">XAxiDma_BdSetVSize()</a> * <a class="el" href="xaxidma__bd_8h.html#97497aa62ab40c865327b211878ffbb8">XAxiDma_BdGetVSize()</a> <b> For xaxidma driver v7_00_a ---------------------------------------------------</b></li><li><b>New API * XAxiDma_GetRxIndexRing(InstancePtr, RingIndex)</b></li></ul>
</b><p>
<b><b><ul>
<li>Changed APIs All the APIs changed in v6_00_a are reverted back for backward compatibility.  </li></ul>
</b></b>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
</table>
Copyright @ 1995-2014 Xilinx, Inc. All rights reserved. 
