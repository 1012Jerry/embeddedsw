<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   xaxidma_bd.c File Reference
</title>
<link href="$DriverApiDocsCssPath" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xaxidma_bd.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Buffer descriptor (BD) management API implementation.<p>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a jz   05/18/10 First release
 2.00a jz   08/10/10 Second release, added in <a class="el" href="xaxidma__g_8c.html">xaxidma_g.c</a>, <a class="el" href="xaxidma__sinit_8c.html">xaxidma_sinit.c</a>,
                     updated tcl file, added <a class="el" href="xaxidma__porting__guide_8h.html">xaxidma_porting_guide.h</a>
 3.00a jz   11/22/10 Support IP core parameters change
 6.00a srt  01/24/12 Added support for Multi-Channel DMA.<ul>
<li>Changed APIs
			* XAxiDma_BdSetLength(XAxiDma_Bd *BdPtr,
					u32 LenBytes, u32 LengthMask)
       		* <a class="el" href="xaxidma__bd_8h.html#0a3f6db7f8ce62a89619f147967a6a18">XAxiDma_BdGetActualLength(BdPtr, LengthMask)</a>
			* <a class="el" href="xaxidma__bd_8h.html#7818396ebd146644473e0451a49a372a">XAxiDma_BdGetLength(BdPtr, LengthMask)</a>
 8.0   srt  01/29/14 Added support for Micro DMA Mode:</li><li>New API
			 <a class="el" href="xaxidma__bd_8h.html#1c8ff31548a1ca0e4b3af6850f65a5d3">XAxiDma_BdSetBufAddrMicroMode(XAxiDma_Bd*, u32)</a></li></ul>
</pre><p>
<pre> </pre> 
<p>
<code>#include &quot;<a class="el" href="xaxidma__bd_8h.html">xaxidma_bd.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#d7d28eaf7fb0a9db902ce3e143063371">XAxiDma_BdSetLength</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr, u32 LenBytes, u32 LengthMask)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#9e841de3633b0d33755ebc2fc991f9a0">XAxiDma_BdSetBufAddr</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr, u32 Addr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#1c8ff31548a1ca0e4b3af6850f65a5d3">XAxiDma_BdSetBufAddrMicroMode</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr, u32 Addr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#0ba9f2288b5ae1d995c6fd6520086dfd">XAxiDma_BdSetAppWord</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr, int Offset, u32 Word)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#5c112b83e66c1a925fc671efceef0c68">XAxiDma_BdGetAppWord</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr, int Offset, int *Valid)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#3c40fd8a2c694719aed7f2dffc967ca4">XAxiDma_BdSetCtrl</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr, u32 Data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#32a07f23f7284137663000cbc6f208b0">XAxiDma_DumpBd</a> (<a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *BdPtr)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="5c112b83e66c1a925fc671efceef0c68"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdGetAppWord" ref="5c112b83e66c1a925fc671efceef0c68" args="(XAxiDma_Bd *BdPtr, int Offset, int *Valid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">u32 XAxiDma_BdGetAppWord           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>Valid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the APP word at the specified APP word offset for a BD.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Offset</em>&nbsp;</td><td>is the offset inside the APP word, it is valid from 0 to 4 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Valid</em>&nbsp;</td><td>is to tell the caller whether parameters are valid</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The APP word. Passed in parameter Valid holds 0 for failure, and 1 for success.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="0ba9f2288b5ae1d995c6fd6520086dfd"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetAppWord" ref="0ba9f2288b5ae1d995c6fd6520086dfd" args="(XAxiDma_Bd *BdPtr, int Offset, u32 Word)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiDma_BdSetAppWord           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Word</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the APP word at the specified APP word offset for a BD.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Offset</em>&nbsp;</td><td>is the offset inside the APP word, it is valid from 0 to 4 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Word</em>&nbsp;</td><td>is the value to set</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM under following error conditions: 1) StsCntrlStrm is not built in hardware 2) Offset is not in valid range</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>If the hardware build has C_SG_USE_STSAPP_LENGTH set to 1, then the last APP word, XAXIDMA_LAST_APPWORD, must have non-zero value when AND with 0x7FFFFF. Not doing so will cause the hardware to stall. This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="9e841de3633b0d33755ebc2fc991f9a0"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetBufAddr" ref="9e841de3633b0d33755ebc2fc991f9a0" args="(XAxiDma_Bd *BdPtr, u32 Addr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiDma_BdSetBufAddr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Addr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the BD's buffer address.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Addr</em>&nbsp;</td><td>is the address to set</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if buffer address set successfully</li><li>XST_INVALID_PARAM if hardware has no DRE and address is not aligned</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="1c8ff31548a1ca0e4b3af6850f65a5d3"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetBufAddrMicroMode" ref="1c8ff31548a1ca0e4b3af6850f65a5d3" args="(XAxiDma_Bd *BdPtr, u32 Addr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiDma_BdSetBufAddrMicroMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Addr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the BD's buffer address when configured for Micro Mode. The buffer address should be 4K aligned.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Addr</em>&nbsp;</td><td>is the address to set</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if buffer address set successfully</li><li>XST_INVALID_PARAM if hardware has no DRE and address is not aligned</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="3c40fd8a2c694719aed7f2dffc967ca4"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetCtrl" ref="3c40fd8a2c694719aed7f2dffc967ca4" args="(XAxiDma_Bd *BdPtr, u32 Data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XAxiDma_BdSetCtrl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>Data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the control bits for a BD.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Data</em>&nbsp;</td><td>is the bit value to set</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="d7d28eaf7fb0a9db902ce3e143063371"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetLength" ref="d7d28eaf7fb0a9db902ce3e143063371" args="(XAxiDma_Bd *BdPtr, u32 LenBytes, u32 LengthMask)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int XAxiDma_BdSetLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>LenBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthMask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the length field for the given BD.<p>
Length has to be non-zero and less than LengthMask.<p>
For TX channels, the value passed in should be the number of bytes to transmit from the TX buffer associated with the given BD.<p>
For RX channels, the value passed in should be the size of the RX buffer associated with the given BD in bytes. This is to notify the RX channel the capability of the RX buffer to avoid buffer overflow.<p>
The actual receive length can be equal or smaller than the specified length. The actual transfer length will be updated by the hardware in the XAXIDMA_BD_STS_OFFSET word in the BD.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LenBytes</em>&nbsp;</td><td>is the requested transfer length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LengthMask</em>&nbsp;</td><td>is the maximum transfer length</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li><li>XST_INVALID_PARAM for invalid BD length</li></ul>
</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="32a07f23f7284137663000cbc6f208b0"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_DumpBd" ref="32a07f23f7284137663000cbc6f208b0" args="(XAxiDma_Bd *BdPtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void XAxiDma_DumpBd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="xaxidma__bd_8h.html#afd3b643f4cd8899af5078d649f19a6f">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>BdPtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Dump the fields of a BD.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>
    </td>
  </tr>
</table>
Copyright @ 1995-2014 Xilinx, Inc. All rights reserved. 
